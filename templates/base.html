<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='images/favicon.ico') }}">
    <title>Rate Inn</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/loader.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/base.css') }}">
    
</head>
<body>

    <div class="main-container d-flex">
        <div class="sidebar fixed-top" id="side_nav">
            <div class="header-box pt-3 px-2 pb-4 d-flex justify-content-between">
                <a href="{{url_for('home')}}" class="text-decoration-none text-color"><h2 class="fs-4"><span class="me-2 "><img src="{{ url_for('static', filename='images/logo.png') }}" width="30" height="30" alt="" class="img-hover-zoom rounded-circle border"></span><span class="text-white w-100">Rate Inn</span></h2></a>
                <button class="btn d-md-none d-block close-btn px-1 py-0 text-white"><i class="fa-solid fa-bars-staggered"></i></button>
            </div>
            <ul class="list-unstyled px-2">
                 <li class="active"><a href="#" class="text-decoration-none px-3 py-2 d-block active" id="showDivLink"><i class="fa-solid fa-house"></i> Dashboard</a></li>
                 <li class=""><a href="#" class="text-decoration-none px-3 py-2 d-block" id="showDivLink-2"><i class="fa-solid fa-face-smile"></i></i> Rating Prediction</a></li>
            </ul>
            <hr class="h-color text-white mx-2">

            <ul class="list-unstyled px-2">
                <li class="dropdown"><a href="#" class="text-decoration-none dropdown-toggle px-3 py-2" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false"><i class="fa-solid fa-gear"></i> Appearance</a>
                    <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                        <li><button class="dropdown-item" id="effect_1">Dark</button></li>
                        <li><button class="dropdown-item" id="effect_2">Light</button></li>
                      </ul>
                </li>
                <li class="dropdown log-control"><a href="#" class="text-decoration-none dropdown-toggle px-3 py-2" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                    <img src="{{ url_for('static', filename='images/profile.png') }}" alt="" width="30" height="30" class="rounded"> {{session.userinfo.name.split(' ')[0]}}!
                </a>
                    <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                        <li><a href="{{url_for('logout')}}" class="dropdown-item">Log Out</a></li>
                      </ul>
                </li>

            </ul>
        </div>
        <div class="content">
            <nav class="navbar navbar-expand-lg navbar-light bg-light">
                <div class="container-fluid">
                <div class="d-flex justify-content-between d-sm-none d-md-block  d-none d-sm-block">
                    <i class="fa-regular fa-snowflake fa-spin fa-spin-reverse fs-4" style="color: #000000;"></i>
                </div>
                <div class="d-flex justify-content-between d-md-none d-block">
                  <a class="navbar-brand fs-4" href="#"><img src="{{ url_for('static', filename='images/logo.png') }}" alt="" width="30" height="30" class="rounded-circle border"> Rate Inn</a>
                  <button class="btn px-1 py-0 open-btn"><i class="fa-solid fa-bars-staggered"></i></button>
                </div>
                <form class="d-flex">
                    <div class="sm-log-control" id="navbarNavDarkDropdown">
                      <ul class="navbar-nav">
                        <li class="nav-item dropdown">
                          <button class="btn btn-transparent dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                            <img src="{{ url_for('static', filename='images/profile.png') }}" alt="" width="30" height="30" class="rounded"> {{session.userinfo.name.split(' ')[0]}}!
                          </button>
                          <ul class="dropdown-menu dropdown-menu-dark">
                            <li><a class="dropdown-item" href="{{url_for('logout')}}">Log Out</a></li>
                          </ul>
                        </li>
                      </ul>
                    </div>
                  </form>
                </div>
            </nav>
            
            <div class="dashboard-container px-3" id="myDiv">
                <h3 class="p-3 text-dark">Dashboard <a href="{{url_for('base')}}" class="btn btn-danger">Activate it</a></h3>
                <div class="dash-container row m-auto rounded shadow-sm border my-2">
                  <div class="col m-auto border">
                    <h5 class="py-1">Total Restaurant <i class="fa-solid fa-utensils"></i></h5>
                    <p style="text-shadow: 1px 1px 5px rgba(64, 64, 64, 0.957);">43499</p>
                  </div>
                  <div class="col m-auto border">
                    <h5 class="py-1 text-dark">Max Price <i class="fa-solid fa-money-check"></i></i></h5>
                    <p style="text-shadow: 1px 1px 5px rgba(64, 64, 64, 0.957);">3000</p>
                  </div>
                  <div class="col m-auto border">
                    <h5 class="py-1">Average Price <i class="fa-solid fa-money-check"></i></h5>
                    <p style="text-shadow: 1px 1px 5px rgba(64, 64, 64, 0.957);">297</p>
                  </div>
                  <div class="col m-auto border">
                    <h5 class="py-1">Max Rating <i class="fa-solid fa-star"></i></h5>
                    <p style="text-shadow: 1px 1px 5px rgba(64, 64, 64, 0.957);">4.9</p>
                  </div>
                </div>

                <div class="dash-container dash-2 row m-auto">
                  <div class="col border rounded shadow-sm mx-1" id="divToCapture">
                    <div class="d-flex justify-content-between">
                      <h5 class="text-left py-1">Orders of Restaurant</h5>
                      <div class="dropstart py-1">
                        <button class="dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" style="border: none; background: transparent;">
                          <i class="fa-solid fa-list"></i>
                        </button>
                        <ul class="dropdown-menu">
                          <li><button id="captureButton" class="dropdown-item">Save</button></li>
                        </ul>
                      </div>
                    </div>
                    
                    <canvas id="myPieChart" class="m-auto p-1"></canvas>
                  </div>

                  <div class="col border rounded shadow-sm mx-1" id="divToCapture2">
                    <div class="d-flex justify-content-between">
                      <h5 class="text-left py-1">Most Liked Restaurant</h5>
                      <div class="dropstart py-1">
                        <button class="dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" style="border: none; background: transparent;">
                          <i class="fa-solid fa-list"></i>
                        </button>
                        <ul class="dropdown-menu">
                          <li><button id="captureButton2" class="dropdown-item">Save</button></li>
                        </ul>
                      </div>
                    </div>
                    <canvas id="barChart"></canvas>
                  </div>
                </div>

                <div class="dash-container dash-2 row m-auto mt-2">
                  <div class="col border rounded shadow-sm mx-1" id="divToCapture4">
                    <div class="d-flex justify-content-between">
                      <h5 class="text-left py-1">Favourite Cuisines</h5>
                      <div class="dropstart py-1">
                        <button class="dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" style="border: none; background: transparent;">
                          <i class="fa-solid fa-list"></i>
                        </button>
                        <ul class="dropdown-menu">
                          <li><button id="captureButton4" class="dropdown-item">Save</button></li>
                        </ul>
                      </div>
                    </div>
                    
                    <canvas id="cuisineChart" class="m-auto p-1 w-100"></canvas>
                  </div>

                  <div class="col border rounded shadow-sm mx-1" id="divToCapture5">
                    <div class="d-flex justify-content-between">
                      <h5 class="text-left py-1">Food Point Location</h5>
                      <div class="dropstart py-1">
                        <button class="dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" style="border: none; background: transparent;">
                          <i class="fa-solid fa-list"></i>
                        </button>
                        <ul class="dropdown-menu">
                          <li><button id="captureButton5" class="dropdown-item">Save</button></li>
                        </ul>
                      </div>
                    </div>
                    <canvas id="locChart" class="w-100"></canvas>
                  </div>
                </div>

                <div class="dash-container m-auto my-2 border rounded shadow-sm" id="divToCapture3">
                  <div class="d-flex justify-content-between px-3 py-1">
                    <h5 class="text-left py-1">Restaurant Categories</h5>
                    <div class="dropstart py-1">
                      <button class="dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" style="border: none; background: transparent;">
                        <i class="fa-solid fa-list"></i>
                      </button>
                      <ul class="dropdown-menu">
                        <li><button id="captureButton3" class="dropdown-item">Save</button></li>
                      </ul>
                    </div>
                  </div>
                  <canvas id="lineChart" class="px-3"></canvas>
                </div>

                <div class="dash-container m-auto my-3 rounded">
                  <h6 class="text-secondary px-2" style="text-decoration: underline;">Note*</h6>
                  <p class="text-secondary px-2">
                    The data visualization includes Zomato data within the boundaries of Bangalore.
                  </p>
                </div>
            </div>

            <div class="dashboard-container-2 px-3" id="myDiv-2">
              <h3 class="p-3 text-dark">Rating Prediction</h3>
              <div class="img-container row m-auto">
                  <div class="col m-auto">
                    <h2 class="text-center">Get Your Restaurant Rating</h2>
                    <h3 class="text-center">with <span class="text-danger">Rate Inn</span></h3>
                    <p class="text-center text-secondary">Solution that should able to predict the ratings<br>of the
                      restaurants listed.</p>
                    <div class="m-auto w-25">
                      <a href="{{url_for('rating_predict')}}" class="btn btn-danger text-center">Prediction time</a>  
                    </div>  
                    
                  </div>
                  <div class="col">
                    <img src="{{ url_for('static', filename='images/rating.jpg') }}" alt="" class="w-100 rounded">
                  </div>
              </div>
            </div>
            
        </div>
        
    </div>

    <div class="loader"></div>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="{{ url_for('static', filename='javascript/base.js') }}"></script>
    <script src="{{ url_for('static', filename='javascript/loader.js') }}"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <script>
      $(".sidebar ul li").on('click',function(){
          $(".sidebar ul li.active").removeClass('active');
          $(this).addClass('active');
      })

      $('.open-btn').on('click',function(){
          $('.sidebar').addClass('active');
      })

      $('.close-btn').on('click',function(){
          $('.sidebar').removeClass('active');
      })
  </script>

  <!-- plot script -->
  <script>
    var chartData = JSON.parse('{{ pi_data|safe }}');
        
        var ctx = document.getElementById('myPieChart').getContext('2d');
        var myPieChart = new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: chartData.labels,
                datasets: [{
                    data: chartData.values,
                    backgroundColor: ['green', 'red'],
                    borderWidth: 1
                }],
            },
            options: {
                tooltips: {
                    callbacks: {
                        label: function(tooltipItem, data) {
                            var label = data.labels[tooltipItem.index];
                            var value = data.datasets[tooltipItem.datasetIndex].data[tooltipItem.index];
                            var percentage = chartData.percentages[tooltipItem.index];
                            return label + ': ' + value + ' (' + percentage + '%)';
                        }
                    }
                }
            }
        });
  </script>
  <script>
var ctx = document.getElementById('barChart').getContext('2d');
var labels = JSON.parse('{{bar_label|safe}}');
var values = JSON.parse('{{bar_values|safe}}');

new Chart(ctx, {
    type: 'bar',
    data: {
        labels: labels,
        datasets: [{
            label: 'Top Rated Restaurant',
            data: values,
            backgroundColor: 'rgba(75, 192, 192, 0.2)',
            borderColor: 'rgba(75, 192, 192, 1)',
            borderWidth: 1
        }]
    },
    options: {
        scales: {
            y: {
                beginAtZero: true
            }
        }
    }
});
  </script>
  <script>
    var ctx = document.getElementById('lineChart').getContext('2d');
var labels = JSON.parse('{{types_label|safe}}');
var values = JSON.parse('{{types_values|safe}}');

new Chart(ctx, {
    type: 'line',
    data: {
        labels: labels,
        datasets: [{
            label: 'Top Categories',
            data: values,
            backgroundColor: 'rgba(255,235,0,1)',
            borderColor: 'rgba(161,2,2,1)',
            borderWidth: 1
        }]
    },
    options: {
        scales: {
            y: {
                beginAtZero: true
            }
        }
    }
});
  </script>
  <script>
    var ctx = document.getElementById('cuisineChart').getContext('2d');
var labels = ['North Indian', 'North Indian & Chinese', 'South Indian', 'Bakery & Desserts', 'Biryani'];
var values = JSON.parse('{{cuisines_values|safe}}');
console.log(labels)
console.log(values)

new Chart(ctx, {
    type: 'bar',
    data: {
        labels: labels,
        datasets: [{
            label: 'Top Rated Cuisines',
            data: values,
            backgroundColor: 'rgb(255,165,64,0.2)',
            borderColor: 'rgb(255,140,0)',
            borderWidth: 1
        }]
    },
    options: {
        scales: {
            y: {
                beginAtZero: true
            }
        }
    }
});
  </script>
  <script>
    var ctx = document.getElementById('locChart').getContext('2d');
var labels = JSON.parse('{{loc_label|safe}}');
var values = JSON.parse('{{loc_values|safe}}');

new Chart(ctx, {
    type: 'line',
    data: {
        labels: labels,
        datasets: [{
            label: 'Number of Restautant / location',
            data: values,
            backgroundColor: 'rgba(255,135,0,1)',
            borderColor: 'rgba(161,1,1,1)',
            borderWidth: 1
        }]
    },
    options: {
        scales: {
            y: {
                beginAtZero: true
            }
        }
    }
});
  </script>
</body>
</html>
